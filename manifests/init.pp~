class ntp {
   case $operatingsystem {
      centos, redhat: { 
         $service_name = 'ntpd'
      }
      debian, ubuntu: { 
         $service_name = 'ntp'
      }
   }

   case $network_eth0 {
     '192.168.64.0',
     '192.168.65.0',
     '192.168.100.0': {
       $network = 'external'
       $ntp_servers = [ "ntp.bastions.cp.local prefer",
                        "time.dfw1.rackspace.com",
                        "0.centos.pool.ntp.org",
                        "1.centos.pool.ntp.org",
                        "2.centos.pool.ntp.org", ]
     }
     '192.168.10.0',
     '192.168.66.0',
     '192.168.101.0',
     '192.168.102.0',
     '192.168.103.0',
     '192.168.104.0',
     '192.168.105.0',
     '192.168.106.0',
     '192.168.107.0',
     '192.168.108.0',
     '192.168.109.0',
     '192.168.110.0',
     '192.168.111.0',
     '192.168.112.0',
     '192.168.113.0',
     '192.168.114.0',
     '192.168.115.0': {
       $network = 'internal'
       $ntp_servers = [ "ntp.bastions.cp.local prefer" ]
     }
   }

   package { 'ntp':
      ensure => installed,
   }
      
   service { 'ntp':
      name      => $service_name,
      ensure    => running,
      enable    => true,
      subscribe => File['ntp.conf'],
   }
      
   file { 'ntp.conf':
      path    => '/etc/ntp.conf',
      ensure  => file,
      require => Package['ntp'],
      content  => template("ntp/ntp.conf.erb"),
   }
}
